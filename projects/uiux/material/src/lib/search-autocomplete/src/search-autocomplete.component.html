<mat-form-field [ngClass]="{'mat-form-field-label-wrapper-focus': inputBlur, 'override-mat': overrideMaterial }">
  <input
    class="search-autocomplete-input"
    [formControl]="control"
    [placeholder]="placeholder"
    name="search"
    matInput
    type="text"
    [matAutocomplete]="auto"
    (focus)="detectChanges(); inputBlur = false;"
    (blur)="detectChanges(); inputBlur = true;"
    (keyup.enter)="onSubmitHandler()"/>
  <button mat-button
          class="search-autocomplete-search-icon"
          *ngIf="!isSearching && iconLeft"
          matPrefix
          mat-icon-button
          aria-label="Search"
          [disabled]="control.invalid || control.pristine"
          (click)="$event.stopPropagation(); onSubmitHandler()">
    <mat-icon>search</mat-icon>
  </button>
  <button matPrefix
          class="search-autocomplete-spinner pad-top-9"
          mat-icon-button
          *ngIf="isSearching && iconLeft">
    <mat-progress-spinner
      [diameter]="spinnerConfig.diameter"
      [strokeWidth]="spinnerConfig.strokeWidth"
      [mode]="'indeterminate'">
    </mat-progress-spinner>
  </button>

  <button mat-button
          class="search-autocomplete-search-icon"
          *ngIf="!isSearching && !iconLeft"
          matSuffix
          mat-icon-button
          aria-label="Search"
          (click)="$event.stopPropagation(); onSubmitHandler()"
          [disabled]="control.invalid || control.pristine">
    <mat-icon>search</mat-icon>
  </button>
  <button matSuffix
          class="search-autocomplete-spinner pad-top-9"
          mat-icon-button
          *ngIf="isSearching && !iconLeft">
    <mat-progress-spinner
      [diameter]="spinnerConfig.diameter"
      [strokeWidth]="spinnerConfig.strokeWidth"
      [mode]="'indeterminate'">
    </mat-progress-spinner>
  </button>
  <mat-error>{{control?.errors | spShowSingleError}}</mat-error>
</mat-form-field>

<mat-autocomplete #auto="matAutocomplete"
                  class="search-autocomplete"
                  (optionSelected)="onOptionSelected($event)"
                  [displayWith]="displayWith">
  <mat-option *ngFor="let option of autoCompleteData" [value]="option">
    <span [innerHtml]="formatOptionText(option)"></span>
  </mat-option>
</mat-autocomplete>
